üìò Log started at 2025-05-18 11:27:37.817761

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2010_bronx.xls...
‚úÖ 4755 rows loaded from 2010_bronx

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2011_bronx.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 4963 rows loaded from 2011_bronx

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2012_bronx.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 5151 rows loaded from 2012_bronx

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2013_bronx.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 5932 rows loaded from 2013_bronx

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2014_bronx.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 6208 rows loaded from 2014_bronx

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2015_bronx.xls...
‚úÖ 6736 rows loaded from 2015_bronx

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2016_bronx.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 7203 rows loaded from 2016_bronx

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2017_bronx.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 7730 rows loaded from 2017_bronx
‚ö†Ô∏è File not found for 2018 bronx: Skipping

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2019_bronx.xlsx...
‚úÖ 8269 rows loaded from 2019_bronx

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2020_bronx.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3029.0, 36.0, 'A5', '418 EAST 180 STREET', None, 10457.0, 1.0, 0.0, 1.0, 1568.0, 1526.0, 1899.0, 1.0, 'A5', 0, 44021.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3030.0, 65.0, 'A1', '4455 PARK AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1622.0, 1587.0, 1899.0, 1.0, 'A1', 458000, 43861.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3030.0, 67.0, 'A1', '4451 PARK AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1646.0, 1495.0, 1899.0, 1.0, 'A1', 275000, 43906.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3030.0, 67.0, 'A1', '4451 PARK AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1646.0, 1495.0, 1899.0, 1.0, 'A1', 475000, 44035.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3039.0, 29.0, 'A9', '2327 WASHINGTON AVE', None, 10458.0, 1.0, 0.0, 1.0, 1095.0, 1260.0, 1910.0, 1.0, 'A9', 165000, 43892.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3045.0, 12.0, 'A1', '2052 BATHGATE AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 2340.0, 1516.0, 1910.0, 1.0, 'A1', 289000, 44068.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3046.0, 52.0, 'B3', '2047 BATHGATE AVENUE', None, 10457.0, 2.0, 0.0, 2.0, 2329.0, 1431.0, 1901.0, 1.0, 'A1', 526000, 44096.0), (2.0, 'BATHGATE', '02 TWO FAMILY DWELLINGS', '1', 2912.0, 118.0, 'B1', '1540 WASHINGTON AVENUE', None, 10457.0, 2.0, 0.0, 2.0, 2000.0, 2400.0, 1993.0, 1.0, 'B1', 0, 44006.0)  ... displaying 10 of 6645 total bound parameter sets ...  (2.0, 'WOODLAWN', '10 COOPS - ELEVATOR APARTMENTS', '2', 3398.0, 97.0, 'D4', '4295 WEBSTER AVENUE, 6L', None, 10470.0, None, None, None, None, None, 1957.0, 2.0, 'D4', 178000, 44140.0), (2.0, 'WOODLAWN', '10 COOPS - ELEVATOR APARTMENTS', '2', 3398.0, 97.0, 'D4', '4295 WEBSTER AVENUE, L3', None, 10470.0, None, None, None, None, None, 1957.0, 2.0, 'D4', 129000, 44074.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    df.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3029.0, 36.0, 'A5', '418 EAST 180 STREET', None, 10457.0, 1.0, 0.0, 1.0, 1568.0, 1526.0, 1899.0, 1.0, 'A5', 0, 44021.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3030.0, 65.0, 'A1', '4455 PARK AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1622.0, 1587.0, 1899.0, 1.0, 'A1', 458000, 43861.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3030.0, 67.0, 'A1', '4451 PARK AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1646.0, 1495.0, 1899.0, 1.0, 'A1', 275000, 43906.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3030.0, 67.0, 'A1', '4451 PARK AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1646.0, 1495.0, 1899.0, 1.0, 'A1', 475000, 44035.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3039.0, 29.0, 'A9', '2327 WASHINGTON AVE', None, 10458.0, 1.0, 0.0, 1.0, 1095.0, 1260.0, 1910.0, 1.0, 'A9', 165000, 43892.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3045.0, 12.0, 'A1', '2052 BATHGATE AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 2340.0, 1516.0, 1910.0, 1.0, 'A1', 289000, 44068.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3046.0, 52.0, 'B3', '2047 BATHGATE AVENUE', None, 10457.0, 2.0, 0.0, 2.0, 2329.0, 1431.0, 1901.0, 1.0, 'A1', 526000, 44096.0), (2.0, 'BATHGATE', '02 TWO FAMILY DWELLINGS', '1', 2912.0, 118.0, 'B1', '1540 WASHINGTON AVENUE', None, 10457.0, 2.0, 0.0, 2.0, 2000.0, 2400.0, 1993.0, 1.0, 'B1', 0, 44006.0)  ... displaying 10 of 6645 total bound parameter sets ...  (2.0, 'WOODLAWN', '10 COOPS - ELEVATOR APARTMENTS', '2', 3398.0, 97.0, 'D4', '4295 WEBSTER AVENUE, 6L', None, 10470.0, None, None, None, None, None, 1957.0, 2.0, 'D4', 178000, 44140.0), (2.0, 'WOODLAWN', '10 COOPS - ELEVATOR APARTMENTS', '2', 3398.0, 97.0, 'D4', '4295 WEBSTER AVENUE, L3', None, 10470.0, None, None, None, None, None, 1957.0, 2.0, 'D4', 129000, 44074.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2021_bronx.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3028.0, 23.0, 'A1', '408 EAST 179TH STREET', None, 10457.0, 1.0, 0.0, 1.0, 1842.0, 2048.0, 1901.0, 1.0, 'A1', 0, 44216.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3028.0, 24.0, 'A1', '410 EAST 179TH STREET', None, 10457.0, 1.0, 0.0, 1.0, 1842.0, 2048.0, 1901.0, 1.0, 'A1', 600000, 44211.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3039.0, 63.0, 'A1', '469 EAST 185TH STREET', None, 10458.0, 1.0, 0.0, 1.0, 1650.0, 1296.0, 1910.0, 1.0, 'A1', 455000, 44553.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3045.0, 12.0, 'A1', '2052 BATHGATE AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 2340.0, 1516.0, 1910.0, 1.0, 'A1', 580000, 44399.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3046.0, 39.0, 'A1', '2075 BATHGATE AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1986.0, 1344.0, 1899.0, 1.0, 'A1', 0, 44456.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3048.0, 28.0, 'A1', '540 E 182ND STREET', None, 10457.0, 1.0, 0.0, 1.0, 1209.0, 1048.0, 1901.0, 1.0, 'A1', 0, 44482.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3053.0, 108.0, 'A9', '2317 BASSFORD AVENUE', None, 10458.0, 1.0, 0.0, 1.0, 925.0, 1188.0, 1901.0, 1.0, 'A9', 251600, 44425.0), (2.0, 'BATHGATE', '02 TWO FAMILY DWELLINGS', '1', 2912.0, 135.0, 'B1', '492 CLAREMONT PARKWAY', None, 10457.0, 2.0, 0.0, 2.0, 2000.0, 2400.0, 1993.0, 1.0, 'B1', 655000, 44295.0)  ... displaying 10 of 7692 total bound parameter sets ...  (2.0, 'WOODLAWN', '29 COMMERCIAL GARAGES', '4', 3395.0, 63.0, 'G1', '4219 WEBSTER AVENUE', None, 10470.0, 0.0, 1.0, 1.0, 10593.0, 2574.0, 1931.0, 4.0, 'G1', 3000000, 44547.0), (2.0, 'WOODLAWN', '30 WAREHOUSES', '4', 3395.0, 44.0, 'E1', '4221 PETERS PLACE', None, 10470.0, 0.0, 1.0, 1.0, 2142.0, 1250.0, 1931.0, 4.0, 'E1', 120000, 44378.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    df.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3028.0, 23.0, 'A1', '408 EAST 179TH STREET', None, 10457.0, 1.0, 0.0, 1.0, 1842.0, 2048.0, 1901.0, 1.0, 'A1', 0, 44216.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3028.0, 24.0, 'A1', '410 EAST 179TH STREET', None, 10457.0, 1.0, 0.0, 1.0, 1842.0, 2048.0, 1901.0, 1.0, 'A1', 600000, 44211.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3039.0, 63.0, 'A1', '469 EAST 185TH STREET', None, 10458.0, 1.0, 0.0, 1.0, 1650.0, 1296.0, 1910.0, 1.0, 'A1', 455000, 44553.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3045.0, 12.0, 'A1', '2052 BATHGATE AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 2340.0, 1516.0, 1910.0, 1.0, 'A1', 580000, 44399.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3046.0, 39.0, 'A1', '2075 BATHGATE AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1986.0, 1344.0, 1899.0, 1.0, 'A1', 0, 44456.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3048.0, 28.0, 'A1', '540 E 182ND STREET', None, 10457.0, 1.0, 0.0, 1.0, 1209.0, 1048.0, 1901.0, 1.0, 'A1', 0, 44482.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3053.0, 108.0, 'A9', '2317 BASSFORD AVENUE', None, 10458.0, 1.0, 0.0, 1.0, 925.0, 1188.0, 1901.0, 1.0, 'A9', 251600, 44425.0), (2.0, 'BATHGATE', '02 TWO FAMILY DWELLINGS', '1', 2912.0, 135.0, 'B1', '492 CLAREMONT PARKWAY', None, 10457.0, 2.0, 0.0, 2.0, 2000.0, 2400.0, 1993.0, 1.0, 'B1', 655000, 44295.0)  ... displaying 10 of 7692 total bound parameter sets ...  (2.0, 'WOODLAWN', '29 COMMERCIAL GARAGES', '4', 3395.0, 63.0, 'G1', '4219 WEBSTER AVENUE', None, 10470.0, 0.0, 1.0, 1.0, 10593.0, 2574.0, 1931.0, 4.0, 'G1', 3000000, 44547.0), (2.0, 'WOODLAWN', '30 WAREHOUSES', '4', 3395.0, 44.0, 'E1', '4221 PETERS PLACE', None, 10470.0, 0.0, 1.0, 1.0, 2142.0, 1250.0, 1931.0, 4.0, 'E1', 120000, 44378.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2022_bronx.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 2905.0, 26.0, 'A9', '1667 WASHINGTON AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 4750.0, 3167.0, 1899.0, 1.0, 'A9', 980000, 44812.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3028.0, 24.0, 'A1', '410 EAST 179TH STREET', None, 10457.0, 1.0, 0.0, 1.0, 1842.0, 2048.0, 1901.0, 1.0, 'A1', 655000, 44866.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3030.0, 65.0, 'A1', '4455 PARK AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1622.0, 1587.0, 1899.0, 1.0, 'A1', 520000, 44860.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3037.0, 101.0, 'S0', '443 EAST 180 STREET', None, 10457.0, 1.0, 2.0, 3.0, 1293.0, 2820.0, 1952.0, 1.0, 'S0', 720000, 44615.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3039.0, 29.0, 'A5', '2327 WASHINGTON AVE', None, 10458.0, 1.0, 0.0, 1.0, 1095.0, 1260.0, 1910.0, 1.0, 'A5', 499999, 44679.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3039.0, 63.0, 'A1', '469 EAST 185 STREET', None, 10458.0, 1.0, 0.0, 1.0, 1650.0, 1296.0, 1910.0, 1.0, 'A1', 599000, 44698.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3046.0, 38.0, 'A1', '2077 BATHGATE AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 2306.0, 1622.0, 1899.0, 1.0, 'A1', 540000, 44670.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3050.0, 80.0, 'A1', '2257 BATHGATE AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 2295.0, 1354.0, 1901.0, 1.0, 'A1', 0, 44797.0)  ... displaying 10 of 7300 total bound parameter sets ...  (2.0, 'WOODLAWN', '22 STORE BUILDINGS', '4', 3380.0, 46.0, 'K1', '4361 KATONAH AVENUE', None, 10470.0, 0.0, 1.0, 1.0, 9698.0, 3400.0, 1970.0, 4.0, 'K1', 0, 44907.0), (2.0, 'WOODLAWN', '22 STORE BUILDINGS', '4', 3385.0, 5.0, 'K4', '4300 KATONAH AVENUE', None, 10470.0, 2.0, 2.0, 4.0, 2330.0, 2425.0, 1931.0, 4.0, 'K4', 0, 44698.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    df.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 2905.0, 26.0, 'A9', '1667 WASHINGTON AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 4750.0, 3167.0, 1899.0, 1.0, 'A9', 980000, 44812.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3028.0, 24.0, 'A1', '410 EAST 179TH STREET', None, 10457.0, 1.0, 0.0, 1.0, 1842.0, 2048.0, 1901.0, 1.0, 'A1', 655000, 44866.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3030.0, 65.0, 'A1', '4455 PARK AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1622.0, 1587.0, 1899.0, 1.0, 'A1', 520000, 44860.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3037.0, 101.0, 'S0', '443 EAST 180 STREET', None, 10457.0, 1.0, 2.0, 3.0, 1293.0, 2820.0, 1952.0, 1.0, 'S0', 720000, 44615.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3039.0, 29.0, 'A5', '2327 WASHINGTON AVE', None, 10458.0, 1.0, 0.0, 1.0, 1095.0, 1260.0, 1910.0, 1.0, 'A5', 499999, 44679.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3039.0, 63.0, 'A1', '469 EAST 185 STREET', None, 10458.0, 1.0, 0.0, 1.0, 1650.0, 1296.0, 1910.0, 1.0, 'A1', 599000, 44698.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3046.0, 38.0, 'A1', '2077 BATHGATE AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 2306.0, 1622.0, 1899.0, 1.0, 'A1', 540000, 44670.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3050.0, 80.0, 'A1', '2257 BATHGATE AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 2295.0, 1354.0, 1901.0, 1.0, 'A1', 0, 44797.0)  ... displaying 10 of 7300 total bound parameter sets ...  (2.0, 'WOODLAWN', '22 STORE BUILDINGS', '4', 3380.0, 46.0, 'K1', '4361 KATONAH AVENUE', None, 10470.0, 0.0, 1.0, 1.0, 9698.0, 3400.0, 1970.0, 4.0, 'K1', 0, 44907.0), (2.0, 'WOODLAWN', '22 STORE BUILDINGS', '4', 3385.0, 5.0, 'K4', '4300 KATONAH AVENUE', None, 10470.0, 2.0, 2.0, 4.0, 2330.0, 2425.0, 1931.0, 4.0, 'K4', 0, 44698.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2023_bronx.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3030.0, 66.0, 'A1', '4453 PARK AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1646.0, 1497.0, 1899.0, 1.0, 'A1', 215000, 45034.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3030.0, 66.0, 'A1', '4453 PARK AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1646.0, 1497.0, 1899.0, 1.0, 'A1', 570000, 45161.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3035.0, 52.0, 'A1', '461 EAST 178 STREET', None, 10457.0, 1.0, 0.0, 1.0, 1782.0, 1548.0, 1899.0, 1.0, 'A1', 0, 45030.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3053.0, 86.0, 'S0', '2364 WASHINGTON AVENUE', None, 10458.0, 1.0, 2.0, 3.0, 1911.0, 4080.0, 1931.0, 1.0, 'S0', 0, 45223.0), (2.0, 'BATHGATE', '02 TWO FAMILY DWELLINGS', '1', 2904.0, 22.0, 'B9', '454 EAST 172 STREET', None, 10457.0, 2.0, 0.0, 2.0, 1658.0, 1428.0, 1901.0, 1.0, 'B9', 350000, 45103.0), (2.0, 'BATHGATE', '02 TWO FAMILY DWELLINGS', '1', 2904.0, 22.0, 'B9', '454 EAST 172ND STREET', None, 10457.0, 2.0, 0.0, 2.0, 1658.0, 1428.0, 1901.0, 1.0, 'B9', 310000, 45152.0), (2.0, 'BATHGATE', '02 TWO FAMILY DWELLINGS', '1', 2912.0, 144.0, 'B1', '3813 3 AVENUE', None, 10457.0, 2.0, 0.0, 2.0, 2000.0, 2400.0, 1993.0, 1.0, 'B1', 763000, 45176.0), (2.0, 'BATHGATE', '02 TWO FAMILY DWELLINGS', '1', 2912.0, 151.0, 'B1', '519 EAST 171 STREET', None, 10457.0, 2.0, 0.0, 2.0, 2000.0, 2400.0, 1993.0, 1.0, 'B1', 750000, 45064.0)  ... displaying 10 of 5920 total bound parameter sets ...  (2.0, 'WOODLAWN', '22 STORE BUILDINGS', '4', 3380.0, 46.0, 'K1', '4361 KATONAH AVENUE', None, 10470.0, 0.0, 1.0, 1.0, 9699.0, 3400.0, 1970.0, 4.0, 'K1', 0, 45033.0), (2.0, 'WOODLAWN', '35 INDOOR PUBLIC AND CULTURAL FACILITIES', '4', 3380.0, 54.0, 'P8', '4351 KATONAH AVENUE', None, 10470.0, 0.0, 1.0, 1.0, 3121.0, 2520.0, 1970.0, 4.0, 'P8', 0, 45033.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    df.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3030.0, 66.0, 'A1', '4453 PARK AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1646.0, 1497.0, 1899.0, 1.0, 'A1', 215000, 45034.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3030.0, 66.0, 'A1', '4453 PARK AVENUE', None, 10457.0, 1.0, 0.0, 1.0, 1646.0, 1497.0, 1899.0, 1.0, 'A1', 570000, 45161.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3035.0, 52.0, 'A1', '461 EAST 178 STREET', None, 10457.0, 1.0, 0.0, 1.0, 1782.0, 1548.0, 1899.0, 1.0, 'A1', 0, 45030.0), (2.0, 'BATHGATE', '01 ONE FAMILY DWELLINGS', '1', 3053.0, 86.0, 'S0', '2364 WASHINGTON AVENUE', None, 10458.0, 1.0, 2.0, 3.0, 1911.0, 4080.0, 1931.0, 1.0, 'S0', 0, 45223.0), (2.0, 'BATHGATE', '02 TWO FAMILY DWELLINGS', '1', 2904.0, 22.0, 'B9', '454 EAST 172 STREET', None, 10457.0, 2.0, 0.0, 2.0, 1658.0, 1428.0, 1901.0, 1.0, 'B9', 350000, 45103.0), (2.0, 'BATHGATE', '02 TWO FAMILY DWELLINGS', '1', 2904.0, 22.0, 'B9', '454 EAST 172ND STREET', None, 10457.0, 2.0, 0.0, 2.0, 1658.0, 1428.0, 1901.0, 1.0, 'B9', 310000, 45152.0), (2.0, 'BATHGATE', '02 TWO FAMILY DWELLINGS', '1', 2912.0, 144.0, 'B1', '3813 3 AVENUE', None, 10457.0, 2.0, 0.0, 2.0, 2000.0, 2400.0, 1993.0, 1.0, 'B1', 763000, 45176.0), (2.0, 'BATHGATE', '02 TWO FAMILY DWELLINGS', '1', 2912.0, 151.0, 'B1', '519 EAST 171 STREET', None, 10457.0, 2.0, 0.0, 2.0, 2000.0, 2400.0, 1993.0, 1.0, 'B1', 750000, 45064.0)  ... displaying 10 of 5920 total bound parameter sets ...  (2.0, 'WOODLAWN', '22 STORE BUILDINGS', '4', 3380.0, 46.0, 'K1', '4361 KATONAH AVENUE', None, 10470.0, 0.0, 1.0, 1.0, 9699.0, 3400.0, 1970.0, 4.0, 'K1', 0, 45033.0), (2.0, 'WOODLAWN', '35 INDOOR PUBLIC AND CULTURAL FACILITIES', '4', 3380.0, 54.0, 'P8', '4351 KATONAH AVENUE', None, 10470.0, 0.0, 1.0, 1.0, 3121.0, 2520.0, 1970.0, 4.0, 'P8', 0, 45033.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2010_brooklyn.xls...
‚úÖ 19649 rows loaded from 2010_brooklyn

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2011_brooklyn.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 20726 rows loaded from 2011_brooklyn

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2012_brooklyn.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 23492 rows loaded from 2012_brooklyn

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2013_brooklyn.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 24842 rows loaded from 2013_brooklyn

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2014_brooklyn.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 25361 rows loaded from 2014_brooklyn

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2015_brooklyn.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 25362 rows loaded from 2015_brooklyn

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2016_brooklyn.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 25519 rows loaded from 2016_brooklyn

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2017_brooklyn.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 24792 rows loaded from 2017_brooklyn
‚ö†Ô∏è File not found for 2018 brooklyn: Skipping

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2019_brooklyn.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: int is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6363, 22, 'A9', '8645 16TH AVENUE', None, 11214, 1.0, 0.0, 1.0, 2058.0, 1492.0, 1930.0, 1, 'A9', 0, 43578), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6363, 48, 'A9', '12 BAY 13TH STREET', None, 11214, 1.0, 0.0, 1.0, 3142.0, 3200.0, 1999.0, 1, 'A9', 0, 43523), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6363, 48, 'A9', '12 BAY 13TH STREET', None, 11214, 1.0, 0.0, 1.0, 3142.0, 3200.0, 1999.0, 1, 'A9', 0, 43507), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6364, 74, 'A5', '72 BAY 14TH STREET', None, 11214, 1.0, 0.0, 1.0, 2492.0, 972.0, 1950.0, 1, 'A5', 0, 43692), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6367, 42, 'S1', '1730 86TH STREET', None, 11214, 1.0, 1.0, 2.0, 1342.0, 1920.0, 1926.0, 1, 'S1', 1630000, 43504), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6367, 43, 'S1', '1732 86TH STREET', None, 11214, 1.0, 1.0, 2.0, 1342.0, 1920.0, 1926.0, 1, 'S1', 1630000, 43504), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6370, 66, 'A9', '28 BAY 20TH STREET', None, 11214, 1.0, 0.0, 1.0, 2417.0, 1584.0, 1930.0, 1, 'A9', 0, 43634), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6370, 66, 'A9', '28 BAY 20TH STREET', None, 11214, 1.0, 0.0, 1.0, 2417.0, 1584.0, 1930.0, 1, 'A9', 0, 43627)  ... displaying 10 of 23276 total bound parameter sets ...  (3, 'WYCKOFF HEIGHTS', '47 CONDO NON-BUSINESS STORAGE', '4', 3280, 1126, 'RS', '369 HARMAN STREET, S8', 'S8', 11237, 0.0, 1.0, 1.0, 0.0, 0.0, 2009.0, 4, 'RS', 725000, 43588), (3, 'WYCKOFF HEIGHTS', '47 CONDO NON-BUSINESS STORAGE', '4', 3280, 1130, 'RS', '369 HARMAN STREET, S12', 'S12', 11237, 0.0, 1.0, 1.0, 0.0, 0.0, 2009.0, 4, 'RS', 1122000, 43585))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: int is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    df.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: int is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6363, 22, 'A9', '8645 16TH AVENUE', None, 11214, 1.0, 0.0, 1.0, 2058.0, 1492.0, 1930.0, 1, 'A9', 0, 43578), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6363, 48, 'A9', '12 BAY 13TH STREET', None, 11214, 1.0, 0.0, 1.0, 3142.0, 3200.0, 1999.0, 1, 'A9', 0, 43523), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6363, 48, 'A9', '12 BAY 13TH STREET', None, 11214, 1.0, 0.0, 1.0, 3142.0, 3200.0, 1999.0, 1, 'A9', 0, 43507), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6364, 74, 'A5', '72 BAY 14TH STREET', None, 11214, 1.0, 0.0, 1.0, 2492.0, 972.0, 1950.0, 1, 'A5', 0, 43692), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6367, 42, 'S1', '1730 86TH STREET', None, 11214, 1.0, 1.0, 2.0, 1342.0, 1920.0, 1926.0, 1, 'S1', 1630000, 43504), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6367, 43, 'S1', '1732 86TH STREET', None, 11214, 1.0, 1.0, 2.0, 1342.0, 1920.0, 1926.0, 1, 'S1', 1630000, 43504), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6370, 66, 'A9', '28 BAY 20TH STREET', None, 11214, 1.0, 0.0, 1.0, 2417.0, 1584.0, 1930.0, 1, 'A9', 0, 43634), (3, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6370, 66, 'A9', '28 BAY 20TH STREET', None, 11214, 1.0, 0.0, 1.0, 2417.0, 1584.0, 1930.0, 1, 'A9', 0, 43627)  ... displaying 10 of 23276 total bound parameter sets ...  (3, 'WYCKOFF HEIGHTS', '47 CONDO NON-BUSINESS STORAGE', '4', 3280, 1126, 'RS', '369 HARMAN STREET, S8', 'S8', 11237, 0.0, 1.0, 1.0, 0.0, 0.0, 2009.0, 4, 'RS', 725000, 43588), (3, 'WYCKOFF HEIGHTS', '47 CONDO NON-BUSINESS STORAGE', '4', 3280, 1130, 'RS', '369 HARMAN STREET, S12', 'S12', 11237, 0.0, 1.0, 1.0, 0.0, 0.0, 2009.0, 4, 'RS', 1122000, 43585))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2020_brooklyn.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6359.0, 70.0, 'S1', '8684 15TH AVENUE', None, 11228.0, 1.0, 1.0, 2.0, 1933.0, 4080.0, 1930.0, 1.0, 'S1', 1300000, 43949.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6360.0, 48.0, 'A5', '14 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 2513.0, 1428.0, 1930.0, 1.0, 'A5', 849000, 43908.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6360.0, 56.0, 'A5', '30 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 1547.0, 1428.0, 1930.0, 1.0, 'A5', 75000, 44165.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6362.0, 23.0, 'A9', '43 BAY 11TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 2280.0, 1052.0, 1901.0, 1.0, 'A9', 0, 44139.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6367.0, 24.0, 'A9', '8645 BAY 16TH STREET', None, 11214.0, 1.0, 0.0, 1.0, 1571.0, 1456.0, 1935.0, 1.0, 'A9', 830000, 44008.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6371.0, 19.0, 'A9', '79 BAY 20TH STREET', None, 11214.0, 1.0, 0.0, 1.0, 2320.0, 1566.0, 1930.0, 1.0, 'A9', 0, 43882.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6371.0, 60.0, 'A9', '8620 19TH AVENUE', None, 11214.0, 1.0, 0.0, 1.0, 2417.0, 2106.0, 1930.0, 1.0, 'A9', 1188000, 44032.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6392.0, 65.0, 'A2', '140 BAY 8 STREET', None, 11228.0, 1.0, 0.0, 1.0, 3222.0, 1804.0, 1940.0, 1.0, 'A2', 975000, 43851.0)  ... displaying 10 of 19899 total bound parameter sets ...  (3.0, 'WYCKOFF HEIGHTS', '44 CONDO PARKING', '4', 3328.0, 1086.0, 'RP', '358 GROVE ST, P25', 'P25', 11237.0, 0.0, 1.0, 1.0, 0.0, 0.0, None, 4.0, 'RP', 1, 43899.0), (3.0, 'WYCKOFF HEIGHTS', '44 CONDO PARKING', '4', 3328.0, 1123.0, 'RP', '358 GROVE STREET, CB10', 'CB10', 11237.0, 0.0, 1.0, 1.0, 0.0, 0.0, None, 4.0, 'RP', 485000, 43881.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    df.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6359.0, 70.0, 'S1', '8684 15TH AVENUE', None, 11228.0, 1.0, 1.0, 2.0, 1933.0, 4080.0, 1930.0, 1.0, 'S1', 1300000, 43949.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6360.0, 48.0, 'A5', '14 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 2513.0, 1428.0, 1930.0, 1.0, 'A5', 849000, 43908.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6360.0, 56.0, 'A5', '30 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 1547.0, 1428.0, 1930.0, 1.0, 'A5', 75000, 44165.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6362.0, 23.0, 'A9', '43 BAY 11TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 2280.0, 1052.0, 1901.0, 1.0, 'A9', 0, 44139.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6367.0, 24.0, 'A9', '8645 BAY 16TH STREET', None, 11214.0, 1.0, 0.0, 1.0, 1571.0, 1456.0, 1935.0, 1.0, 'A9', 830000, 44008.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6371.0, 19.0, 'A9', '79 BAY 20TH STREET', None, 11214.0, 1.0, 0.0, 1.0, 2320.0, 1566.0, 1930.0, 1.0, 'A9', 0, 43882.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6371.0, 60.0, 'A9', '8620 19TH AVENUE', None, 11214.0, 1.0, 0.0, 1.0, 2417.0, 2106.0, 1930.0, 1.0, 'A9', 1188000, 44032.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6392.0, 65.0, 'A2', '140 BAY 8 STREET', None, 11228.0, 1.0, 0.0, 1.0, 3222.0, 1804.0, 1940.0, 1.0, 'A2', 975000, 43851.0)  ... displaying 10 of 19899 total bound parameter sets ...  (3.0, 'WYCKOFF HEIGHTS', '44 CONDO PARKING', '4', 3328.0, 1086.0, 'RP', '358 GROVE ST, P25', 'P25', 11237.0, 0.0, 1.0, 1.0, 0.0, 0.0, None, 4.0, 'RP', 1, 43899.0), (3.0, 'WYCKOFF HEIGHTS', '44 CONDO PARKING', '4', 3328.0, 1123.0, 'RP', '358 GROVE STREET, CB10', 'CB10', 11237.0, 0.0, 1.0, 1.0, 0.0, 0.0, None, 4.0, 'RP', 485000, 43881.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2021_brooklyn.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6364.0, 74.0, 'A5', '72 BAY 14TH ST.', None, 11214.0, 1.0, 0.0, 1.0, 2492.0, 972.0, 1950.0, 1.0, 'A5', 0, 44337.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6364.0, 74.0, 'A5', '72 BAY 14TH STREET', None, 11214.0, 1.0, 0.0, 1.0, 2492.0, 972.0, 1950.0, 1.0, 'A5', 890000, 44477.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6367.0, 24.0, 'A9', '8645 BAY 16 STREE', None, 11214.0, 1.0, 0.0, 1.0, 1571.0, 1456.0, 1935.0, 1.0, 'A9', 925000, 44503.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6370.0, 65.0, 'A9', '26 BAY 20TH STREET', None, 11214.0, 1.0, 0.0, 1.0, 2417.0, 1584.0, 1930.0, 1.0, 'A9', 0, 44443.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6373.0, 85.0, 'A1', '84 BAY 23RD STREET', None, 11214.0, 1.0, 0.0, 1.0, 5738.0, 2514.0, 1935.0, 1.0, 'A1', 0, 44536.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6380.0, 73.0, 'S1', '8672 BAY PARKWAY', None, 11214.0, 1.0, 1.0, 2.0, 1740.0, 2124.0, 1960.0, 1.0, 'S1', 990000, 44249.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6395.0, 15.0, 'A9', '147 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 1933.0, 2391.0, 1925.0, 1.0, 'A9', 0, 44365.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6410.0, 54.0, 'A1', '122 BAY 26TH STREET', None, 11214.0, 1.0, 0.0, 1.0, 9667.0, 3972.0, 1901.0, 1.0, 'A1', 0, 44404.0)  ... displaying 10 of 28965 total bound parameter sets ...  (3.0, 'WYCKOFF HEIGHTS', '44 CONDO PARKING', '4', 3310.0, 1012.0, 'RP', '330 BLEECKER STREET, PK4', 'PK4', 11237.0, None, 1.0, 1.0, None, None, 2013.0, 4.0, 'RP', 875000, 44474.0), (3.0, 'WYCKOFF HEIGHTS', '47 CONDO NON-BUSINESS STORAGE', '4', 3280.0, 1125.0, 'RS', '369 HARMAN STREET, S7', 'S7', 11237.0, None, 1.0, 1.0, None, None, 2009.0, 4.0, 'RS', 629000, 44307.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    df.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6364.0, 74.0, 'A5', '72 BAY 14TH ST.', None, 11214.0, 1.0, 0.0, 1.0, 2492.0, 972.0, 1950.0, 1.0, 'A5', 0, 44337.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6364.0, 74.0, 'A5', '72 BAY 14TH STREET', None, 11214.0, 1.0, 0.0, 1.0, 2492.0, 972.0, 1950.0, 1.0, 'A5', 890000, 44477.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6367.0, 24.0, 'A9', '8645 BAY 16 STREE', None, 11214.0, 1.0, 0.0, 1.0, 1571.0, 1456.0, 1935.0, 1.0, 'A9', 925000, 44503.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6370.0, 65.0, 'A9', '26 BAY 20TH STREET', None, 11214.0, 1.0, 0.0, 1.0, 2417.0, 1584.0, 1930.0, 1.0, 'A9', 0, 44443.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6373.0, 85.0, 'A1', '84 BAY 23RD STREET', None, 11214.0, 1.0, 0.0, 1.0, 5738.0, 2514.0, 1935.0, 1.0, 'A1', 0, 44536.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6380.0, 73.0, 'S1', '8672 BAY PARKWAY', None, 11214.0, 1.0, 1.0, 2.0, 1740.0, 2124.0, 1960.0, 1.0, 'S1', 990000, 44249.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6395.0, 15.0, 'A9', '147 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 1933.0, 2391.0, 1925.0, 1.0, 'A9', 0, 44365.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6410.0, 54.0, 'A1', '122 BAY 26TH STREET', None, 11214.0, 1.0, 0.0, 1.0, 9667.0, 3972.0, 1901.0, 1.0, 'A1', 0, 44404.0)  ... displaying 10 of 28965 total bound parameter sets ...  (3.0, 'WYCKOFF HEIGHTS', '44 CONDO PARKING', '4', 3310.0, 1012.0, 'RP', '330 BLEECKER STREET, PK4', 'PK4', 11237.0, None, 1.0, 1.0, None, None, 2013.0, 4.0, 'RP', 875000, 44474.0), (3.0, 'WYCKOFF HEIGHTS', '47 CONDO NON-BUSINESS STORAGE', '4', 3280.0, 1125.0, 'RS', '369 HARMAN STREET, S7', 'S7', 11237.0, None, 1.0, 1.0, None, None, 2009.0, 4.0, 'RS', 629000, 44307.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2022_brooklyn.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6360.0, 56.0, 'A5', '30 BAY 10', None, 11228.0, 1.0, 0.0, 1.0, 1546.0, 1428.0, 1930.0, 1.0, 'A5', 75000, 44713.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6360.0, 157.0, 'A5', '36 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 1547.0, 1428.0, 1930.0, 1.0, 'A5', 0, 44638.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6363.0, 22.0, 'A9', '8645 16TH AVENUE', None, 11214.0, 1.0, 0.0, 1.0, 2058.0, 1492.0, 1930.0, 1.0, 'A9', 875000, 44568.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6363.0, 48.0, 'A9', '12 BAY 13TH ST', None, 11214.0, 1.0, 0.0, 1.0, 3142.0, 3200.0, 1999.0, 1.0, 'A9', 0, 44634.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6363.0, 62.0, 'A9', '44 BAY 13TH STREET', None, 11214.0, 1.0, 0.0, 1.0, 3575.0, 2104.0, 1901.0, 1.0, 'A9', 990000, 44852.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6372.0, 34.0, 'A9', '8637 19TH AVENUE', None, 11214.0, 1.0, 0.0, 1.0, 2417.0, 2154.0, 1930.0, 1.0, 'A9', 0, 44824.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6373.0, 73.0, 'A1', '50 BAY 23RD STREET', None, 11214.0, 1.0, 0.0, 1.0, 2417.0, 1672.0, 1930.0, 1.0, 'A1', 0, 44791.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6373.0, 85.0, 'A1', '84 BAY 23RD STREET', None, 11214.0, 1.0, 0.0, 1.0, 5737.0, 2514.0, 1935.0, 1.0, 'A1', 0, 44743.0)  ... displaying 10 of 26855 total bound parameter sets ...  (3.0, 'WYCKOFF HEIGHTS', '44 CONDO PARKING', '4', 3280.0, 1133.0, 'RP', '369 HARMAN STREET, P3', 'P3', 11237.0, None, 1.0, 1.0, None, None, 2009.0, 4.0, 'RP', 0, 44677.0), (3.0, 'WYCKOFF HEIGHTS', '44 CONDO PARKING', '4', 3280.0, 1134.0, 'RP', '369 HARMAN STREET, P4', 'P4', 11237.0, None, 1.0, 1.0, None, None, 2009.0, 4.0, 'RP', 0, 44677.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    df.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6360.0, 56.0, 'A5', '30 BAY 10', None, 11228.0, 1.0, 0.0, 1.0, 1546.0, 1428.0, 1930.0, 1.0, 'A5', 75000, 44713.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6360.0, 157.0, 'A5', '36 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 1547.0, 1428.0, 1930.0, 1.0, 'A5', 0, 44638.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6363.0, 22.0, 'A9', '8645 16TH AVENUE', None, 11214.0, 1.0, 0.0, 1.0, 2058.0, 1492.0, 1930.0, 1.0, 'A9', 875000, 44568.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6363.0, 48.0, 'A9', '12 BAY 13TH ST', None, 11214.0, 1.0, 0.0, 1.0, 3142.0, 3200.0, 1999.0, 1.0, 'A9', 0, 44634.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6363.0, 62.0, 'A9', '44 BAY 13TH STREET', None, 11214.0, 1.0, 0.0, 1.0, 3575.0, 2104.0, 1901.0, 1.0, 'A9', 990000, 44852.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6372.0, 34.0, 'A9', '8637 19TH AVENUE', None, 11214.0, 1.0, 0.0, 1.0, 2417.0, 2154.0, 1930.0, 1.0, 'A9', 0, 44824.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6373.0, 73.0, 'A1', '50 BAY 23RD STREET', None, 11214.0, 1.0, 0.0, 1.0, 2417.0, 1672.0, 1930.0, 1.0, 'A1', 0, 44791.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6373.0, 85.0, 'A1', '84 BAY 23RD STREET', None, 11214.0, 1.0, 0.0, 1.0, 5737.0, 2514.0, 1935.0, 1.0, 'A1', 0, 44743.0)  ... displaying 10 of 26855 total bound parameter sets ...  (3.0, 'WYCKOFF HEIGHTS', '44 CONDO PARKING', '4', 3280.0, 1133.0, 'RP', '369 HARMAN STREET, P3', 'P3', 11237.0, None, 1.0, 1.0, None, None, 2009.0, 4.0, 'RP', 0, 44677.0), (3.0, 'WYCKOFF HEIGHTS', '44 CONDO PARKING', '4', 3280.0, 1134.0, 'RP', '369 HARMAN STREET, P4', 'P4', 11237.0, None, 1.0, 1.0, None, None, 2009.0, 4.0, 'RP', 0, 44677.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2023_brooklyn.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6360.0, 56.0, 'A5', '30 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 1547.0, 1428.0, 1930.0, 1.0, 'A5', 0, 45138.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6360.0, 68.0, 'A5', '58 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 1547.0, 1428.0, 1930.0, 1.0, 'A5', 925000, 45141.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6361.0, 22.0, 'A5', '43 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 2900.0, 1660.0, 1930.0, 1.0, 'A5', 1275000, 45267.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6362.0, 23.0, 'A9', '43 BAY 11TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 2280.0, 1052.0, 1901.0, 1.0, 'A9', 825000, 45016.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6367.0, 42.0, 'S1', '1730 86TH STREET', None, 11214.0, 1.0, 1.0, 2.0, 1342.0, 1920.0, 1926.0, 1.0, 'S1', 1505000, 45037.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6367.0, 43.0, 'S1', '1732 86TH STREET', None, 11214.0, 1.0, 1.0, 2.0, 1342.0, 1920.0, 1926.0, 1.0, 'S1', 1650000, 45177.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6373.0, 54.0, 'S1', '1948 86TH STREET', None, 11214.0, 1.0, 1.0, 2.0, 1917.0, 2870.0, 1931.0, 1.0, 'S1', 0, 45258.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6373.0, 77.0, 'A9', '60 BAY 23RD STREET', None, 11214.0, 1.0, 0.0, 1.0, 1933.0, 2372.0, 1925.0, 1.0, 'A9', 925000, 45264.0)  ... displaying 10 of 21635 total bound parameter sets ...  (3.0, 'WYCKOFF HEIGHTS', '44 CONDO PARKING', '4', 3328.0, 1091.0, 'RP', '358 GROVE STREET, P30', 'P30', 11237.0, None, 1.0, 1.0, None, None, None, 4.0, 'RP', 0, 45079.0), (3.0, 'WYCKOFF HEIGHTS', '47 CONDO NON-BUSINESS STORAGE', '4', 3280.0, 1129.0, 'RS', '369 HARMAN STREET, S11', 'S11', 11237.0, None, 1.0, 1.0, None, None, 2009.0, 4.0, 'RS', 749000, 45250.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    df.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6360.0, 56.0, 'A5', '30 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 1547.0, 1428.0, 1930.0, 1.0, 'A5', 0, 45138.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6360.0, 68.0, 'A5', '58 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 1547.0, 1428.0, 1930.0, 1.0, 'A5', 925000, 45141.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6361.0, 22.0, 'A5', '43 BAY 10TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 2900.0, 1660.0, 1930.0, 1.0, 'A5', 1275000, 45267.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6362.0, 23.0, 'A9', '43 BAY 11TH STREET', None, 11228.0, 1.0, 0.0, 1.0, 2280.0, 1052.0, 1901.0, 1.0, 'A9', 825000, 45016.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6367.0, 42.0, 'S1', '1730 86TH STREET', None, 11214.0, 1.0, 1.0, 2.0, 1342.0, 1920.0, 1926.0, 1.0, 'S1', 1505000, 45037.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6367.0, 43.0, 'S1', '1732 86TH STREET', None, 11214.0, 1.0, 1.0, 2.0, 1342.0, 1920.0, 1926.0, 1.0, 'S1', 1650000, 45177.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6373.0, 54.0, 'S1', '1948 86TH STREET', None, 11214.0, 1.0, 1.0, 2.0, 1917.0, 2870.0, 1931.0, 1.0, 'S1', 0, 45258.0), (3.0, 'BATH BEACH', '01 ONE FAMILY DWELLINGS', '1', 6373.0, 77.0, 'A9', '60 BAY 23RD STREET', None, 11214.0, 1.0, 0.0, 1.0, 1933.0, 2372.0, 1925.0, 1.0, 'A9', 925000, 45264.0)  ... displaying 10 of 21635 total bound parameter sets ...  (3.0, 'WYCKOFF HEIGHTS', '44 CONDO PARKING', '4', 3328.0, 1091.0, 'RP', '358 GROVE STREET, P30', 'P30', 11237.0, None, 1.0, 1.0, None, None, None, 4.0, 'RP', 0, 45079.0), (3.0, 'WYCKOFF HEIGHTS', '47 CONDO NON-BUSINESS STORAGE', '4', 3280.0, 1129.0, 'RS', '369 HARMAN STREET, S11', 'S11', 11237.0, None, 1.0, 1.0, None, None, 2009.0, 4.0, 'RS', 749000, 45250.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2010_manhattan.xls...
‚úÖ 17296 rows loaded from 2010_manhattan

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2011_manhattan.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 21500 rows loaded from 2011_manhattan

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2012_manhattan.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 26258 rows loaded from 2012_manhattan

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2013_manhattan.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 26715 rows loaded from 2013_manhattan

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2014_manhattan.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 24524 rows loaded from 2014_manhattan

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2015_manhattan.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 24989 rows loaded from 2015_manhattan

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2016_manhattan.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 21241 rows loaded from 2016_manhattan

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2017_manhattan.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 18642 rows loaded from 2017_manhattan
‚ö†Ô∏è File not found for 2018 manhattan: Skipping

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2019_manhattan.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: int is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((1, 'ALPHABET CITY', '01 ONE FAMILY DWELLINGS', '1', 376, 43, 'S1', '743 EAST 6TH STREET', None, 10009, 1.0, 1.0, 2.0, 2090.0, 3680.0, 1940.0, 1, 'S1', 3200000, 43670), (1, 'ALPHABET CITY', '01 ONE FAMILY DWELLINGS', '1', 390, 61, 'A4', '189 EAST 7TH STREET', None, 10009, 1.0, 0.0, 1.0, 987.0, 2183.0, 1860.0, 1, 'A4', 0, 43733), (1, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 404, 1, 'B9', '166 AVENUE A', None, 10009, 2.0, 0.0, 2.0, 1510.0, 4520.0, 1900.0, 1, 'B9', 0, 43668), (1, 'ALPHABET CITY', '03 THREE FAMILY DWELLINGS', '1', 377, 56, 'C0', '263 EAST 7TH STREET', None, 10009, 3.0, 0.0, 3.0, 2430.0, 3600.0, 1899.0, 1, 'C0', 6300000, 43585), (1, 'ALPHABET CITY', '03 THREE FAMILY DWELLINGS', '1', 393, 9, 'C0', '604 EAST 11TH STREET', None, 10009, 3.0, 0.0, 3.0, 2375.0, 5110.0, 1939.0, 1, 'C0', 0, 43762), (1, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 372, 23, 'C1', '300 EAST 3RD STREET', None, 10009, 12.0, 0.0, 12.0, 2393.0, 7989.0, 2001.0, 2, 'C1', 1950000, 43685), (1, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 373, 19, 'C7', '332 EAST 4TH STREET', None, 10009, 28.0, 2.0, 30.0, 4651.0, 17478.0, 1920.0, 2, 'C7', 14000000, 43474), (1, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 375, 28, 'C4', '738 EAST 6TH STREET', None, 10009, 11.0, 0.0, 11.0, 1750.0, 6500.0, 1900.0, 2, 'C4', 0, 43719)  ... displaying 10 of 17583 total bound parameter sets ...  (1, 'WASHINGTON HEIGHTS UPPER', '31 COMMERCIAL VACANT LAND', '4', 2174, 97, 'V1', 'N/A NAGLE AVENUE', None, 10040, 0.0, 0.0, 0.0, 2800.0, 0.0, None, 4, 'V1', 15000, 43628), (1, 'WASHINGTON HEIGHTS UPPER', '32 HOSPITAL AND HEALTH FACILITIES', '4', 2180, 125, 'I5', '4337 BROADWAY', None, 10033, 0.0, 2.0, 2.0, 10700.0, 10745.0, 1953.0, 4, 'I5', 11700929, 43830))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: int is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    if not dry_run:
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: int is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((1, 'ALPHABET CITY', '01 ONE FAMILY DWELLINGS', '1', 376, 43, 'S1', '743 EAST 6TH STREET', None, 10009, 1.0, 1.0, 2.0, 2090.0, 3680.0, 1940.0, 1, 'S1', 3200000, 43670), (1, 'ALPHABET CITY', '01 ONE FAMILY DWELLINGS', '1', 390, 61, 'A4', '189 EAST 7TH STREET', None, 10009, 1.0, 0.0, 1.0, 987.0, 2183.0, 1860.0, 1, 'A4', 0, 43733), (1, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 404, 1, 'B9', '166 AVENUE A', None, 10009, 2.0, 0.0, 2.0, 1510.0, 4520.0, 1900.0, 1, 'B9', 0, 43668), (1, 'ALPHABET CITY', '03 THREE FAMILY DWELLINGS', '1', 377, 56, 'C0', '263 EAST 7TH STREET', None, 10009, 3.0, 0.0, 3.0, 2430.0, 3600.0, 1899.0, 1, 'C0', 6300000, 43585), (1, 'ALPHABET CITY', '03 THREE FAMILY DWELLINGS', '1', 393, 9, 'C0', '604 EAST 11TH STREET', None, 10009, 3.0, 0.0, 3.0, 2375.0, 5110.0, 1939.0, 1, 'C0', 0, 43762), (1, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 372, 23, 'C1', '300 EAST 3RD STREET', None, 10009, 12.0, 0.0, 12.0, 2393.0, 7989.0, 2001.0, 2, 'C1', 1950000, 43685), (1, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 373, 19, 'C7', '332 EAST 4TH STREET', None, 10009, 28.0, 2.0, 30.0, 4651.0, 17478.0, 1920.0, 2, 'C7', 14000000, 43474), (1, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 375, 28, 'C4', '738 EAST 6TH STREET', None, 10009, 11.0, 0.0, 11.0, 1750.0, 6500.0, 1900.0, 2, 'C4', 0, 43719)  ... displaying 10 of 17583 total bound parameter sets ...  (1, 'WASHINGTON HEIGHTS UPPER', '31 COMMERCIAL VACANT LAND', '4', 2174, 97, 'V1', 'N/A NAGLE AVENUE', None, 10040, 0.0, 0.0, 0.0, 2800.0, 0.0, None, 4, 'V1', 15000, 43628), (1, 'WASHINGTON HEIGHTS UPPER', '32 HOSPITAL AND HEALTH FACILITIES', '4', 2180, 125, 'I5', '4337 BROADWAY', None, 10033, 0.0, 2.0, 2.0, 10700.0, 10745.0, 1953.0, 4, 'I5', 11700929, 43830))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2020_manhattan.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((1.0, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 377.0, 72.0, 'B9', '231 EAST 7TH', None, 10009.0, 2.0, 0.0, 2.0, 1718.0, 5154.0, 1901.0, 1.0, 'B9', 0, 44106.0), (1.0, 'ALPHABET CITY', '03 THREE FAMILY DWELLINGS', '1', 377.0, 66.0, 'C0', '243 EAST 7TH STREET', None, 10009.0, 3.0, 0.0, 3.0, 2381.0, 3084.0, 1899.0, 1.0, 'C0', 0, 44135.0), (1.0, 'ALPHABET CITY', '03 THREE FAMILY DWELLINGS', '1', 377.0, 66.0, 'C0', '243 EAST 7TH STREET', None, 10009.0, 3.0, 0.0, 3.0, 2381.0, 3084.0, 1899.0, 1.0, 'C0', 4350000, 44028.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2B', 372.0, 10.0, 'C7', '274 EAST 3RD', None, 10009.0, 9.0, 1.0, 10.0, 2021.0, 6445.0, 1900.0, 2.0, 'C7', 0, 44192.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2B', 374.0, 1.0, 'C7', '301-303 EAST 4TH STREET', None, 10009.0, 8.0, 2.0, 10.0, 1501.0, 6929.0, 1900.0, 2.0, 'C7', 3672530, 44159.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 28.0, 'C4', '272 EAST 7TH STREET', None, 10009.0, 24.0, 0.0, 24.0, 2764.0, 13206.0, 1900.0, 2.0, 'C4', 1, 44008.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 31.0, 'C4', '278 EAST 7TH STREET, 1A', None, 10009.0, 19.0, 0.0, 19.0, 2772.0, 13248.0, 1920.0, 2.0, 'C4', 2500, 43872.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 31.0, 'C4', '278 EAST 7TH STREET, 1B/2B', None, 10009.0, 19.0, 0.0, 19.0, 2772.0, 13248.0, 1920.0, 2.0, 'C4', 290000, 43868.0)  ... displaying 10 of 12880 total bound parameter sets ...  (1.0, 'WASHINGTON HEIGHTS UPPER', '43 CONDO OFFICE BUILDINGS', '4', 2177.0, 1102.0, 'RB', '40 PINEHURST AVENUE, CFB', 'CFB', 10033.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2016.0, 4.0, 'RB', 0, 43950.0), (1.0, 'WASHINGTON HEIGHTS UPPER', '44 CONDO PARKING', '4', 2180.0, 1230.0, 'RG', '736 WEST 187 STREET, PRK30', 'PRK30', 10033.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2003.0, 4.0, 'RG', 1200000, 44189.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    if not dry_run:
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((1.0, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 377.0, 72.0, 'B9', '231 EAST 7TH', None, 10009.0, 2.0, 0.0, 2.0, 1718.0, 5154.0, 1901.0, 1.0, 'B9', 0, 44106.0), (1.0, 'ALPHABET CITY', '03 THREE FAMILY DWELLINGS', '1', 377.0, 66.0, 'C0', '243 EAST 7TH STREET', None, 10009.0, 3.0, 0.0, 3.0, 2381.0, 3084.0, 1899.0, 1.0, 'C0', 0, 44135.0), (1.0, 'ALPHABET CITY', '03 THREE FAMILY DWELLINGS', '1', 377.0, 66.0, 'C0', '243 EAST 7TH STREET', None, 10009.0, 3.0, 0.0, 3.0, 2381.0, 3084.0, 1899.0, 1.0, 'C0', 4350000, 44028.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2B', 372.0, 10.0, 'C7', '274 EAST 3RD', None, 10009.0, 9.0, 1.0, 10.0, 2021.0, 6445.0, 1900.0, 2.0, 'C7', 0, 44192.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2B', 374.0, 1.0, 'C7', '301-303 EAST 4TH STREET', None, 10009.0, 8.0, 2.0, 10.0, 1501.0, 6929.0, 1900.0, 2.0, 'C7', 3672530, 44159.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 28.0, 'C4', '272 EAST 7TH STREET', None, 10009.0, 24.0, 0.0, 24.0, 2764.0, 13206.0, 1900.0, 2.0, 'C4', 1, 44008.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 31.0, 'C4', '278 EAST 7TH STREET, 1A', None, 10009.0, 19.0, 0.0, 19.0, 2772.0, 13248.0, 1920.0, 2.0, 'C4', 2500, 43872.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 31.0, 'C4', '278 EAST 7TH STREET, 1B/2B', None, 10009.0, 19.0, 0.0, 19.0, 2772.0, 13248.0, 1920.0, 2.0, 'C4', 290000, 43868.0)  ... displaying 10 of 12880 total bound parameter sets ...  (1.0, 'WASHINGTON HEIGHTS UPPER', '43 CONDO OFFICE BUILDINGS', '4', 2177.0, 1102.0, 'RB', '40 PINEHURST AVENUE, CFB', 'CFB', 10033.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2016.0, 4.0, 'RB', 0, 43950.0), (1.0, 'WASHINGTON HEIGHTS UPPER', '44 CONDO PARKING', '4', 2180.0, 1230.0, 'RG', '736 WEST 187 STREET, PRK30', 'PRK30', 10033.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2003.0, 4.0, 'RG', 1200000, 44189.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2021_manhattan.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((1.0, 'ALPHABET CITY', '01 ONE FAMILY DWELLINGS', '1', 374.0, 46.0, 'A4', '347 EAST 4TH STREET', None, 10009.0, 1.0, 0.0, 1.0, 2116.0, 4400.0, 1900.0, 1.0, 'A4', 2385000, 44236.0), (1.0, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 377.0, 70.0, 'B1', '235 EAST 7TH STREET', None, 10009.0, 2.0, 0.0, 2.0, 882.0, 2160.0, 2003.0, 1.0, 'B1', 3025000, 44546.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 54.0, 'C4', '719 EAST SIXTH STREET, 5C', None, 10009.0, 20.0, 0.0, 20.0, 2302.0, 9750.0, 1900.0, 2.0, 'C4', 154196, 44358.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 385.0, 46.0, 'C4', '248 EAST 2 STREET', None, 10009.0, 20.0, 0.0, 20.0, 2623.0, 11017.0, 1900.0, 2.0, 'C4', 0, 44515.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 386.0, 53.0, 'C1', '233 EAST 3 STREET', None, 10009.0, 29.0, 0.0, 29.0, 3927.0, 17754.0, 1910.0, 2.0, 'C1', 7500000, 44361.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 390.0, 57.0, 'C7', '197 EAST 7TH STREET', None, 10009.0, 10.0, 1.0, 11.0, 1600.0, 5320.0, 1910.0, 2.0, 'C7', 3425000, 44238.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2A', 392.0, 5.0, 'C2', '151 AVENUE B', None, 10009.0, 5.0, 0.0, 5.0, 2139.0, 4416.0, 1900.0, 2.0, 'C2', 0, 44286.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2B', 394.0, 37.0, 'C4', '656 EAST 12 STREET', None, 10009.0, 9.0, 1.0, 10.0, 1273.0, 6365.0, 1910.0, 2.0, 'C4', 3, 44377.0)  ... displaying 10 of 22756 total bound parameter sets ...  (1.0, 'WASHINGTON HEIGHTS UPPER', '43 CONDO OFFICE BUILDINGS', '4', 2177.0, 1102.0, 'RB', '40 PINEHURST AVENUE', 'CFB', 10033.0, None, 1.0, 1.0, None, None, 2016.0, 4.0, 'RB', 650000, 44357.0), (1.0, 'WASHINGTON HEIGHTS UPPER', '44 CONDO PARKING', '4', 2180.0, 1224.0, 'RG', '736 187TH STREET, PRK24', 'PRK24', 10033.0, None, 1.0, 1.0, None, None, 2003.0, 4.0, 'RG', 1165000, 44433.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    if not dry_run:
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((1.0, 'ALPHABET CITY', '01 ONE FAMILY DWELLINGS', '1', 374.0, 46.0, 'A4', '347 EAST 4TH STREET', None, 10009.0, 1.0, 0.0, 1.0, 2116.0, 4400.0, 1900.0, 1.0, 'A4', 2385000, 44236.0), (1.0, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 377.0, 70.0, 'B1', '235 EAST 7TH STREET', None, 10009.0, 2.0, 0.0, 2.0, 882.0, 2160.0, 2003.0, 1.0, 'B1', 3025000, 44546.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 54.0, 'C4', '719 EAST SIXTH STREET, 5C', None, 10009.0, 20.0, 0.0, 20.0, 2302.0, 9750.0, 1900.0, 2.0, 'C4', 154196, 44358.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 385.0, 46.0, 'C4', '248 EAST 2 STREET', None, 10009.0, 20.0, 0.0, 20.0, 2623.0, 11017.0, 1900.0, 2.0, 'C4', 0, 44515.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 386.0, 53.0, 'C1', '233 EAST 3 STREET', None, 10009.0, 29.0, 0.0, 29.0, 3927.0, 17754.0, 1910.0, 2.0, 'C1', 7500000, 44361.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 390.0, 57.0, 'C7', '197 EAST 7TH STREET', None, 10009.0, 10.0, 1.0, 11.0, 1600.0, 5320.0, 1910.0, 2.0, 'C7', 3425000, 44238.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2A', 392.0, 5.0, 'C2', '151 AVENUE B', None, 10009.0, 5.0, 0.0, 5.0, 2139.0, 4416.0, 1900.0, 2.0, 'C2', 0, 44286.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2B', 394.0, 37.0, 'C4', '656 EAST 12 STREET', None, 10009.0, 9.0, 1.0, 10.0, 1273.0, 6365.0, 1910.0, 2.0, 'C4', 3, 44377.0)  ... displaying 10 of 22756 total bound parameter sets ...  (1.0, 'WASHINGTON HEIGHTS UPPER', '43 CONDO OFFICE BUILDINGS', '4', 2177.0, 1102.0, 'RB', '40 PINEHURST AVENUE', 'CFB', 10033.0, None, 1.0, 1.0, None, None, 2016.0, 4.0, 'RB', 650000, 44357.0), (1.0, 'WASHINGTON HEIGHTS UPPER', '44 CONDO PARKING', '4', 2180.0, 1224.0, 'RG', '736 187TH STREET, PRK24', 'PRK24', 10033.0, None, 1.0, 1.0, None, None, 2003.0, 4.0, 'RG', 1165000, 44433.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2022_manhattan.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((1.0, 'ALPHABET CITY', '01 ONE FAMILY DWELLINGS', '1', 374.0, 46.0, 'A4', '347 EAST 4TH STREET', None, 10009.0, 1.0, 0.0, 1.0, 2116.0, 4400.0, 1900.0, 1.0, 'A4', 399000, 44833.0), (1.0, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 377.0, 1.0, 'S2', '110 AVENUE C', None, 10009.0, 2.0, 1.0, 3.0, 1502.0, 2790.0, 1901.0, 1.0, 'S2', 2999999, 44819.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2B', 373.0, 16.0, 'C1', '326 EAST 4TH STREET', None, 10009.0, 10.0, 0.0, 10.0, 2204.0, 8625.0, 1899.0, 2.0, 'C1', 16800000, 44777.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2B', 373.0, 17.0, 'C1', '328 EAST 4TH STREET', None, 10009.0, 10.0, 0.0, 10.0, 2204.0, 8625.0, 1900.0, 2.0, 'C1', 16800000, 44777.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 54.0, 'C4', '719 EAST SIXTH STREET, 1B', None, 10009.0, 20.0, 0.0, 20.0, 2302.0, 9750.0, 1900.0, 2.0, 'C4', 158822, 44831.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2A', 377.0, 52.0, 'C2', '271 EAST 7TH STREET', None, 10009.0, 5.0, 0.0, 5.0, 2168.0, 3728.0, 1900.0, 2.0, 'C2', 0, 44778.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2A', 377.0, 52.0, 'C2', '271 EAST 7TH STREET', None, 10009.0, 5.0, 0.0, 5.0, 2169.0, 3728.0, 1900.0, 2.0, 'C2', 0, 44691.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2B', 379.0, 25.0, 'C7', '434 EAST 10TH STREET, 4', None, 10009.0, 7.0, 1.0, 8.0, 4337.0, 14347.0, 1920.0, 2.0, 'C7', 1635000, 44778.0)  ... displaying 10 of 21787 total bound parameter sets ...  (1.0, 'WASHINGTON HEIGHTS UPPER', '31 COMMERCIAL VACANT LAND', '4', 2180.0, 64.0, 'V1', 'N/A WEST 184 STREET', None, 10033.0, 0.0, 0.0, 0.0, 27829.0, 0.0, None, 4.0, 'V1', 6000000, 44589.0), (1.0, 'WASHINGTON HEIGHTS UPPER', '37 RELIGIOUS FACILITIES', '4', 2180.0, 27.0, 'M1', '524 FT WASHINGTON AVENUE', None, 10033.0, 0.0, 2.0, 2.0, 8890.0, 24839.0, 1959.0, 4.0, 'M1', 6000000, 44589.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    if not dry_run:
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((1.0, 'ALPHABET CITY', '01 ONE FAMILY DWELLINGS', '1', 374.0, 46.0, 'A4', '347 EAST 4TH STREET', None, 10009.0, 1.0, 0.0, 1.0, 2116.0, 4400.0, 1900.0, 1.0, 'A4', 399000, 44833.0), (1.0, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 377.0, 1.0, 'S2', '110 AVENUE C', None, 10009.0, 2.0, 1.0, 3.0, 1502.0, 2790.0, 1901.0, 1.0, 'S2', 2999999, 44819.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2B', 373.0, 16.0, 'C1', '326 EAST 4TH STREET', None, 10009.0, 10.0, 0.0, 10.0, 2204.0, 8625.0, 1899.0, 2.0, 'C1', 16800000, 44777.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2B', 373.0, 17.0, 'C1', '328 EAST 4TH STREET', None, 10009.0, 10.0, 0.0, 10.0, 2204.0, 8625.0, 1900.0, 2.0, 'C1', 16800000, 44777.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 54.0, 'C4', '719 EAST SIXTH STREET, 1B', None, 10009.0, 20.0, 0.0, 20.0, 2302.0, 9750.0, 1900.0, 2.0, 'C4', 158822, 44831.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2A', 377.0, 52.0, 'C2', '271 EAST 7TH STREET', None, 10009.0, 5.0, 0.0, 5.0, 2168.0, 3728.0, 1900.0, 2.0, 'C2', 0, 44778.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2A', 377.0, 52.0, 'C2', '271 EAST 7TH STREET', None, 10009.0, 5.0, 0.0, 5.0, 2169.0, 3728.0, 1900.0, 2.0, 'C2', 0, 44691.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2B', 379.0, 25.0, 'C7', '434 EAST 10TH STREET, 4', None, 10009.0, 7.0, 1.0, 8.0, 4337.0, 14347.0, 1920.0, 2.0, 'C7', 1635000, 44778.0)  ... displaying 10 of 21787 total bound parameter sets ...  (1.0, 'WASHINGTON HEIGHTS UPPER', '31 COMMERCIAL VACANT LAND', '4', 2180.0, 64.0, 'V1', 'N/A WEST 184 STREET', None, 10033.0, 0.0, 0.0, 0.0, 27829.0, 0.0, None, 4.0, 'V1', 6000000, 44589.0), (1.0, 'WASHINGTON HEIGHTS UPPER', '37 RELIGIOUS FACILITIES', '4', 2180.0, 27.0, 'M1', '524 FT WASHINGTON AVENUE', None, 10033.0, 0.0, 2.0, 2.0, 8890.0, 24839.0, 1959.0, 4.0, 'M1', 6000000, 44589.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2023_manhattan.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((1.0, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 372.0, 36.0, 'S2', '19 AVENUE D', None, 10009.0, 2.0, 1.0, 3.0, 826.0, 2481.0, 1900.0, 1.0, 'S2', 1, 44946.0), (1.0, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 386.0, 7.0, 'S2', '49 AVENUE B', None, 10009.0, 2.0, 1.0, 3.0, 1725.0, 2304.0, 1880.0, 1.0, 'S2', 0, 45232.0), (1.0, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 386.0, 8.0, 'S2', '51 AVENUE B', None, 10009.0, 2.0, 1.0, 3.0, 1530.0, 1920.0, 1880.0, 1.0, 'S2', 0, 45232.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2A', 376.0, 25.0, 'C3', '266 EAST 7TH', None, 10009.0, 4.0, 0.0, 4.0, 2059.0, 3764.0, 1900.0, 2.0, 'C3', 0, 45239.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 41.0, 'C4', '745 EAST 6TH STREET, 3D', None, 10009.0, 28.0, 0.0, 28.0, 4542.0, 18254.0, 1900.0, 2.0, 'C4', 625000, 45273.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 41.0, 'C4', '745 EAST 6TH STREET, 4B', None, 10009.0, 28.0, 0.0, 28.0, 4542.0, 18254.0, 1900.0, 2.0, 'C4', 565000, 45279.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 390.0, 50.0, 'C6', '209 EAST 7TH STREET, 3E', None, 10009.0, 29.0, 0.0, 29.0, 3900.0, 18099.0, 1900.0, 2.0, 'C1', 154196, 45184.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 390.0, 50.0, 'C6', '209 EAST 7TH STREET, 4E', None, 10009.0, 29.0, 0.0, 29.0, 3900.0, 18099.0, 1900.0, 2.0, 'C1', 154196, 45184.0)  ... displaying 10 of 17009 total bound parameter sets ...  (1.0, 'WASHINGTON HEIGHTS UPPER', '43 CONDO OFFICE BUILDINGS', '4', 2180.0, 1602.0, 'RB', '4337 BROADWAY, 2', '2', 10033.0, None, 1.0, 1.0, None, None, 1953.0, 4.0, 'RB', 0, 44930.0), (1.0, 'WASHINGTON HEIGHTS UPPER', '44 CONDO PARKING', '4', 2180.0, 1221.0, 'RG', '736 WEST 187 STREET, PRK21', 'PRK21', 10033.0, None, 1.0, 1.0, None, None, 2003.0, 4.0, 'RG', 1100000, 45191.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    if not dry_run:
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((1.0, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 372.0, 36.0, 'S2', '19 AVENUE D', None, 10009.0, 2.0, 1.0, 3.0, 826.0, 2481.0, 1900.0, 1.0, 'S2', 1, 44946.0), (1.0, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 386.0, 7.0, 'S2', '49 AVENUE B', None, 10009.0, 2.0, 1.0, 3.0, 1725.0, 2304.0, 1880.0, 1.0, 'S2', 0, 45232.0), (1.0, 'ALPHABET CITY', '02 TWO FAMILY DWELLINGS', '1', 386.0, 8.0, 'S2', '51 AVENUE B', None, 10009.0, 2.0, 1.0, 3.0, 1530.0, 1920.0, 1880.0, 1.0, 'S2', 0, 45232.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2A', 376.0, 25.0, 'C3', '266 EAST 7TH', None, 10009.0, 4.0, 0.0, 4.0, 2059.0, 3764.0, 1900.0, 2.0, 'C3', 0, 45239.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 41.0, 'C4', '745 EAST 6TH STREET, 3D', None, 10009.0, 28.0, 0.0, 28.0, 4542.0, 18254.0, 1900.0, 2.0, 'C4', 625000, 45273.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 376.0, 41.0, 'C4', '745 EAST 6TH STREET, 4B', None, 10009.0, 28.0, 0.0, 28.0, 4542.0, 18254.0, 1900.0, 2.0, 'C4', 565000, 45279.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 390.0, 50.0, 'C6', '209 EAST 7TH STREET, 3E', None, 10009.0, 29.0, 0.0, 29.0, 3900.0, 18099.0, 1900.0, 2.0, 'C1', 154196, 45184.0), (1.0, 'ALPHABET CITY', '07 RENTALS - WALKUP APARTMENTS', '2', 390.0, 50.0, 'C6', '209 EAST 7TH STREET, 4E', None, 10009.0, 29.0, 0.0, 29.0, 3900.0, 18099.0, 1900.0, 2.0, 'C1', 154196, 45184.0)  ... displaying 10 of 17009 total bound parameter sets ...  (1.0, 'WASHINGTON HEIGHTS UPPER', '43 CONDO OFFICE BUILDINGS', '4', 2180.0, 1602.0, 'RB', '4337 BROADWAY, 2', '2', 10033.0, None, 1.0, 1.0, None, None, 1953.0, 4.0, 'RB', 0, 44930.0), (1.0, 'WASHINGTON HEIGHTS UPPER', '44 CONDO PARKING', '4', 2180.0, 1221.0, 'RG', '736 WEST 187 STREET, PRK21', 'PRK21', 10033.0, None, 1.0, 1.0, None, None, 2003.0, 4.0, 'RG', 1100000, 45191.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2010_queens.xls...
‚úÖ 21198 rows loaded from 2010_queens

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2011_queens.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 21580 rows loaded from 2011_queens

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2012_queens.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 22949 rows loaded from 2012_queens

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2013_queens.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 25415 rows loaded from 2013_queens

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2014_queens.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 25157 rows loaded from 2014_queens

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2015_queens.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 26354 rows loaded from 2015_queens

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2016_queens.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 27214 rows loaded from 2016_queens

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2017_queens.xls...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚úÖ 27899 rows loaded from 2017_queens
‚ö†Ô∏è File not found for 2018 queens: Skipping

==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2019_queens.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: int is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949, 31, 'A5', '1942 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1, 'A5', 775000, 43560), (4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949, 38, 'A5', '19-56 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1, 'A5', 0, 43634), (4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949, 41, 'A5', '1962 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1, 'A5', 0, 43790), (4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949, 41, 'A5', '1962 81ST ST', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1, 'A5', 0, 43781), (4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976, 12, 'A5', '2114 81 STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1, 'A5', 0, 43579), (4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976, 37, 'A5', '21-64 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1, 'A5', 670000, 43805), (4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976, 61, 'A5', '21-21 80TH STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1, 'A5', 985000, 43734), (4, 'AIRPORT LA GUARDIA', '02 TWO FAMILY DWELLINGS', '1', 949, 60, 'B1', '19-61 80TH STREET', None, 11370.0, 2.0, 0.0, 2.0, 2000.0, 2400.0, 1945.0, 1, 'B1', 990000, 43586)  ... displaying 10 of 26421 total bound parameter sets ...  (4, 'WOODSIDE', '44 CONDO PARKING', '4', 1307, 1122, 'RG', '41-35 67TH STREET, P6', 'P6', 11377.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2007.0, 4, 'RG', 665000, 43755), (4, 'WOODSIDE', '44 CONDO PARKING', '4', 2324, 1111, 'RG', '63-14 QUEENS BOULEVARD, P-6', 'P-6', 11377.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2008.0, 4, 'RG', 28000, 43522))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: int is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    df.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: int is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949, 31, 'A5', '1942 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1, 'A5', 775000, 43560), (4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949, 38, 'A5', '19-56 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1, 'A5', 0, 43634), (4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949, 41, 'A5', '1962 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1, 'A5', 0, 43790), (4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949, 41, 'A5', '1962 81ST ST', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1, 'A5', 0, 43781), (4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976, 12, 'A5', '2114 81 STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1, 'A5', 0, 43579), (4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976, 37, 'A5', '21-64 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1, 'A5', 670000, 43805), (4, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976, 61, 'A5', '21-21 80TH STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1, 'A5', 985000, 43734), (4, 'AIRPORT LA GUARDIA', '02 TWO FAMILY DWELLINGS', '1', 949, 60, 'B1', '19-61 80TH STREET', None, 11370.0, 2.0, 0.0, 2.0, 2000.0, 2400.0, 1945.0, 1, 'B1', 990000, 43586)  ... displaying 10 of 26421 total bound parameter sets ...  (4, 'WOODSIDE', '44 CONDO PARKING', '4', 1307, 1122, 'RG', '41-35 67TH STREET, P6', 'P6', 11377.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2007.0, 4, 'RG', 665000, 43755), (4, 'WOODSIDE', '44 CONDO PARKING', '4', 2324, 1111, 'RG', '63-14 QUEENS BOULEVARD, P-6', 'P-6', 11377.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2008.0, 4, 'RG', 28000, 43522))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2020_queens.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((4.0, 'AIRPORT JFK', '39 TRANSPORTATION FACILITIES', '4', 14260.0, 80.0, 'V7', 'N/A ROCKAWAY BLVD', None, 11434.0, 0.0, 0.0, 0.0, 268092.0, 0.0, None, 4.0, 'T1', 4121000, 44028.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 41.0, 'A5', '19-62 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 584569, 44071.0), (4.0, 'AIRPORT LA GUARDIA', '12 CONDOS - WALKUP APARTMENTS', '2', 949.0, 1003.0, 'R2', '19-37 80TH STREET, 1', '1', 11370.0, 1.0, 0.0, 1.0, 0.0, 0.0, None, 2.0, 'R2', 420000, 43902.0), (4.0, 'ARVERNE', '01 ONE FAMILY DWELLINGS', '1', 15830.0, 20.0, 'A5', '3-20 BEACH 41 STREET', None, 11691.0, 1.0, 0.0, 1.0, 2469.0, 1476.0, 2005.0, 1.0, 'A5', 300000, 44181.0), (4.0, 'ARVERNE', '01 ONE FAMILY DWELLINGS', '1', 15830.0, 27.0, 'A5', '336 BEACH 41ST STREET', None, 11691.0, 1.0, 0.0, 1.0, 2325.0, 1350.0, 2005.0, 1.0, 'A5', 360000, 44005.0), (4.0, 'ARVERNE', '01 ONE FAMILY DWELLINGS', '1', 15831.0, 27.0, 'A5', '344 BEACH 42 STREET', None, 11691.0, 1.0, 0.0, 1.0, 2470.0, 1332.0, 2006.0, 1.0, 'A5', 465000, 44111.0), (4.0, 'ARVERNE', '01 ONE FAMILY DWELLINGS', '1', 15834.0, 51.0, 'A6', '337 BEACH 43', None, 11691.0, 1.0, 0.0, 1.0, 5134.0, 1224.0, 1920.0, 1.0, 'A6', 235000, 44131.0), (4.0, 'ARVERNE', '01 ONE FAMILY DWELLINGS', '1', 15835.0, 32.0, 'A2', '338 BEACH 45 STREET', None, 11691.0, 1.0, 0.0, 1.0, 2723.0, 1070.0, 1920.0, 1.0, 'A2', 0, 44098.0)  ... displaying 10 of 21701 total bound parameter sets ...  (4.0, 'WOODSIDE', '44 CONDO PARKING', '4', 2324.0, 1129.0, 'RG', '63-14 QUEENS BOULEVARD, P-24', 'P-24', 11377.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2008.0, 4.0, 'RG', 24000, 43867.0), (4.0, 'WOODSIDE', '44 CONDO PARKING', '4', 2324.0, 1146.0, 'RG', '63-14 QUEENS BOULEVARD, P-41', 'P-41', 11377.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2008.0, 4.0, 'RG', 760000, 43885.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    df.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((4.0, 'AIRPORT JFK', '39 TRANSPORTATION FACILITIES', '4', 14260.0, 80.0, 'V7', 'N/A ROCKAWAY BLVD', None, 11434.0, 0.0, 0.0, 0.0, 268092.0, 0.0, None, 4.0, 'T1', 4121000, 44028.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 41.0, 'A5', '19-62 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 584569, 44071.0), (4.0, 'AIRPORT LA GUARDIA', '12 CONDOS - WALKUP APARTMENTS', '2', 949.0, 1003.0, 'R2', '19-37 80TH STREET, 1', '1', 11370.0, 1.0, 0.0, 1.0, 0.0, 0.0, None, 2.0, 'R2', 420000, 43902.0), (4.0, 'ARVERNE', '01 ONE FAMILY DWELLINGS', '1', 15830.0, 20.0, 'A5', '3-20 BEACH 41 STREET', None, 11691.0, 1.0, 0.0, 1.0, 2469.0, 1476.0, 2005.0, 1.0, 'A5', 300000, 44181.0), (4.0, 'ARVERNE', '01 ONE FAMILY DWELLINGS', '1', 15830.0, 27.0, 'A5', '336 BEACH 41ST STREET', None, 11691.0, 1.0, 0.0, 1.0, 2325.0, 1350.0, 2005.0, 1.0, 'A5', 360000, 44005.0), (4.0, 'ARVERNE', '01 ONE FAMILY DWELLINGS', '1', 15831.0, 27.0, 'A5', '344 BEACH 42 STREET', None, 11691.0, 1.0, 0.0, 1.0, 2470.0, 1332.0, 2006.0, 1.0, 'A5', 465000, 44111.0), (4.0, 'ARVERNE', '01 ONE FAMILY DWELLINGS', '1', 15834.0, 51.0, 'A6', '337 BEACH 43', None, 11691.0, 1.0, 0.0, 1.0, 5134.0, 1224.0, 1920.0, 1.0, 'A6', 235000, 44131.0), (4.0, 'ARVERNE', '01 ONE FAMILY DWELLINGS', '1', 15835.0, 32.0, 'A2', '338 BEACH 45 STREET', None, 11691.0, 1.0, 0.0, 1.0, 2723.0, 1070.0, 1920.0, 1.0, 'A2', 0, 44098.0)  ... displaying 10 of 21701 total bound parameter sets ...  (4.0, 'WOODSIDE', '44 CONDO PARKING', '4', 2324.0, 1129.0, 'RG', '63-14 QUEENS BOULEVARD, P-24', 'P-24', 11377.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2008.0, 4.0, 'RG', 24000, 43867.0), (4.0, 'WOODSIDE', '44 CONDO PARKING', '4', 2324.0, 1146.0, 'RG', '63-14 QUEENS BOULEVARD, P-41', 'P-41', 11377.0, 0.0, 1.0, 1.0, 0.0, 0.0, 2008.0, 4.0, 'RG', 760000, 43885.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2021_queens.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 24.0, 'A5', '19-28 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 0, 44343.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 30.0, 'A5', '19-40 81ST SREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 935000, 44538.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 12.0, 'A5', '21-14 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 800000, 44207.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 15.0, 'A5', '21-20 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 0, 44316.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 26.0, 'A5', '21-42 81ST ST', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 815000, 44372.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 62.0, 'A5', '21-19 80TH STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 950000, 44425.0), (4.0, 'AIRPORT LA GUARDIA', '02 TWO FAMILY DWELLINGS', '1', 976.0, 1.0, 'B1', '21-01 80TH STREET', None, 11370.0, 2.0, 0.0, 2.0, 2100.0, 2765.0, 1950.0, 1.0, 'B1', 0, 44437.0), (4.0, 'AIRPORT LA GUARDIA', '02 TWO FAMILY DWELLINGS', '1', 976.0, 56.0, 'B3', '21-31 80TH STREET', None, 11370.0, 2.0, 0.0, 2.0, 1800.0, 1224.0, 1950.0, 1.0, 'B3', 805000, 44536.0)  ... displaying 10 of 29812 total bound parameter sets ...  (4.0, 'WOODSIDE', '44 CONDO PARKING', '4', 2324.0, 1152.0, 'RG', '63-14 QUEENS BOULEVARD, P-49', 'P-49', 11377.0, None, 1.0, 1.0, None, None, 2008.0, 4.0, 'RG', 0, 44442.0), (4.0, 'WOODSIDE', '44 CONDO PARKING', '4', 2324.0, 1153.0, 'RG', '63-14 QUEENS BOULEVARD, P-50', 'P-50', 11377.0, None, 1.0, 1.0, None, None, 2008.0, 4.0, 'RG', 0, 44442.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    df.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 24.0, 'A5', '19-28 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 0, 44343.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 30.0, 'A5', '19-40 81ST SREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 935000, 44538.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 12.0, 'A5', '21-14 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 800000, 44207.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 15.0, 'A5', '21-20 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 0, 44316.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 26.0, 'A5', '21-42 81ST ST', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 815000, 44372.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 62.0, 'A5', '21-19 80TH STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 950000, 44425.0), (4.0, 'AIRPORT LA GUARDIA', '02 TWO FAMILY DWELLINGS', '1', 976.0, 1.0, 'B1', '21-01 80TH STREET', None, 11370.0, 2.0, 0.0, 2.0, 2100.0, 2765.0, 1950.0, 1.0, 'B1', 0, 44437.0), (4.0, 'AIRPORT LA GUARDIA', '02 TWO FAMILY DWELLINGS', '1', 976.0, 56.0, 'B3', '21-31 80TH STREET', None, 11370.0, 2.0, 0.0, 2.0, 1800.0, 1224.0, 1950.0, 1.0, 'B3', 805000, 44536.0)  ... displaying 10 of 29812 total bound parameter sets ...  (4.0, 'WOODSIDE', '44 CONDO PARKING', '4', 2324.0, 1152.0, 'RG', '63-14 QUEENS BOULEVARD, P-49', 'P-49', 11377.0, None, 1.0, 1.0, None, None, 2008.0, 4.0, 'RG', 0, 44442.0), (4.0, 'WOODSIDE', '44 CONDO PARKING', '4', 2324.0, 1153.0, 'RG', '63-14 QUEENS BOULEVARD, P-50', 'P-50', 11377.0, None, 1.0, 1.0, None, None, 2008.0, 4.0, 'RG', 0, 44442.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2022_queens.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 34.0, 'A5', '19-48 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1799.0, 1224.0, 1945.0, 1.0, 'A5', 864195, 44757.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 37.0, 'A5', '19-54 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1799.0, 1224.0, 1945.0, 1.0, 'A5', 815000, 44736.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 55.0, 'A5', '21-33 80TH STREET', None, 11370.0, 1.0, 0.0, 1.0, 1799.0, 1224.0, 1950.0, 1.0, 'A5', 830000, 44827.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 60.0, 'A5', '21-23 80TH STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 900000, 44600.0), (4.0, 'AIRPORT LA GUARDIA', '03 THREE FAMILY DWELLINGS', '1', 949.0, 56.0, 'C0', '19-69 80TH STREET', None, 11370.0, 3.0, 0.0, 3.0, 2000.0, 2835.0, 1945.0, 1.0, 'C0', 0, 44628.0), (4.0, 'AIRPORT LA GUARDIA', '03 THREE FAMILY DWELLINGS', '1', 949.0, 56.0, 'C0', '19-69 80TH STREET', None, 11370.0, 3.0, 0.0, 3.0, 2000.0, 2835.0, 1945.0, 1.0, 'C0', 0, 44663.0), (4.0, 'AIRPORT LA GUARDIA', '12 CONDOS - WALKUP APARTMENTS', '2', 949.0, 1017.0, 'R2', '19-17 80TH STREET, 1', '1', 11370.0, 1.0, None, 1.0, None, None, None, 2.0, 'R2', 335000, 44874.0), (4.0, 'AIRPORT LA GUARDIA', '12 CONDOS - WALKUP APARTMENTS', '2', 949.0, 1022.0, 'R2', '19-13 80TH STREET, 2', '2', 11370.0, 1.0, None, 1.0, None, None, None, 2.0, 'R2', 630000, 44768.0)  ... displaying 10 of 28840 total bound parameter sets ...  (4.0, 'WOODSIDE', '44 CONDO PARKING', '4', 2324.0, 1144.0, 'RG', '63-14 QUEENS BOULEVARD, P-39', 'P-39', 11377.0, None, 1.0, 1.0, None, None, 2008.0, 4.0, 'RG', 28000, 44651.0), (4.0, 'WOODSIDE', '46 CONDO STORE BUILDINGS', '4', 1336.0, 1001.0, 'RK', '61-20 WOODSIDE AVENUE, COM-A', 'COM-A', 11377.0, None, 1.0, 1.0, None, None, 1991.0, 4.0, 'RK', 0, 44789.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
    df.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 34.0, 'A5', '19-48 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1799.0, 1224.0, 1945.0, 1.0, 'A5', 864195, 44757.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 37.0, 'A5', '19-54 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1799.0, 1224.0, 1945.0, 1.0, 'A5', 815000, 44736.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 55.0, 'A5', '21-33 80TH STREET', None, 11370.0, 1.0, 0.0, 1.0, 1799.0, 1224.0, 1950.0, 1.0, 'A5', 830000, 44827.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 60.0, 'A5', '21-23 80TH STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 900000, 44600.0), (4.0, 'AIRPORT LA GUARDIA', '03 THREE FAMILY DWELLINGS', '1', 949.0, 56.0, 'C0', '19-69 80TH STREET', None, 11370.0, 3.0, 0.0, 3.0, 2000.0, 2835.0, 1945.0, 1.0, 'C0', 0, 44628.0), (4.0, 'AIRPORT LA GUARDIA', '03 THREE FAMILY DWELLINGS', '1', 949.0, 56.0, 'C0', '19-69 80TH STREET', None, 11370.0, 3.0, 0.0, 3.0, 2000.0, 2835.0, 1945.0, 1.0, 'C0', 0, 44663.0), (4.0, 'AIRPORT LA GUARDIA', '12 CONDOS - WALKUP APARTMENTS', '2', 949.0, 1017.0, 'R2', '19-17 80TH STREET, 1', '1', 11370.0, 1.0, None, 1.0, None, None, None, 2.0, 'R2', 335000, 44874.0), (4.0, 'AIRPORT LA GUARDIA', '12 CONDOS - WALKUP APARTMENTS', '2', 949.0, 1022.0, 'R2', '19-13 80TH STREET, 2', '2', 11370.0, 1.0, None, 1.0, None, None, None, 2.0, 'R2', 630000, 44768.0)  ... displaying 10 of 28840 total bound parameter sets ...  (4.0, 'WOODSIDE', '44 CONDO PARKING', '4', 2324.0, 1144.0, 'RG', '63-14 QUEENS BOULEVARD, P-39', 'P-39', 11377.0, None, 1.0, 1.0, None, None, 2008.0, 4.0, 'RG', 28000, 44651.0), (4.0, 'WOODSIDE', '46 CONDO STORE BUILDINGS', '4', 1336.0, 1001.0, 'RK', '61-20 WOODSIDE AVENUE, COM-A', 'COM-A', 11377.0, None, 1.0, 1.0, None, None, 1991.0, 4.0, 'RK', 0, 44789.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üìÇ Processing C:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Data\2023_queens.xlsx...
‚ö†Ô∏è Dropping unexpected columns: ['ease-ment']
‚ùå Error loading to SQL: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((4.0, 'AIRPORT JFK', '31 COMMERCIAL VACANT LAND', '4', 14260.0, 80.0, 'E1', 'N/A ROCKAWAY BLVD', None, 11434.0, 0.0, 1.0, 1.0, 268092.0, 0.0, 2023.0, 4.0, 'V7', 0, 45224.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 25.0, 'A5', '19-30 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 780000, 45135.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 27.0, 'A5', '19-34 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 820000, 45092.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 38.0, 'A5', '19-56 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 0, 45069.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 41.0, 'A5', '19-62 81 STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 725000, 45215.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 43.0, 'A5', '19-66 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 820000, 45072.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 35.0, 'A5', '2160 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 0, 45291.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 41.0, 'A5', '2161 80 STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 0, 45000.0)  ... displaying 10 of 24256 total bound parameter sets ...  (4.0, 'WOODSIDE', '46 CONDO STORE BUILDINGS', '4', 1216.0, 1102.0, 'RK', '61-05 39TH AVENUE, 1B', '1B', 11377.0, None, 1.0, 1.0, None, None, 1927.0, 4.0, 'RK', 978738, 45114.0), (4.0, 'WOODSIDE', '46 CONDO STORE BUILDINGS', '4', 1216.0, 1103.0, 'RK', '61-05 39TH AVENUE, 1C', '1C', 11377.0, None, 1.0, 1.0, None, None, 1927.0, 4.0, 'RK', 978738, 45114.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
Traceback (most recent call last):
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
pyodbc.DataError: ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "c:\Users\3hmed\OneDrive\Desktop\Data Projects\real_estate_transactions_cleansing_modeling\Python\Ingest_Files_inStaging_DataBase.py", line 174, in <module>
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\util\_decorators.py", line 333, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\core\generic.py", line 3008, in to_sql
    return sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 788, in to_sql
    return pandas_sql.to_sql(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1958, in to_sql
    total_inserted = sql_engine.insert_records(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1507, in insert_records
    raise err
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1498, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 1059, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\pandas\io\sql.py", line 951, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\sql\elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\util\compat.py", line 211, in raise_
    raise exception
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\dialects\mssql\pyodbc.py", line 649, in do_executemany
    super(MSDialect_pyodbc, self).do_executemany(
  File "C:\Users\3hmed\AppData\Local\Packages\PythonSoftwareFoundation.Python.3.10_qbz5n2kfra8p0\LocalCache\local-packages\Python310\site-packages\sqlalchemy\engine\default.py", line 733, in do_executemany
    cursor.executemany(statement, parameters)
sqlalchemy.exc.DataError: (pyodbc.DataError) ('22018', '[22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Operand type clash: float is incompatible with date (206) (SQLExecDirectW); [22018] [Microsoft][ODBC Driver 17 for SQL Server][SQL Server]Statement(s) could not be prepared. (8180)')
[SQL: INSERT INTO staging.property_sales_raw (borough, neighborhood, building_class_category, tax_class_at_present, block, lot, building_class_at_present, address, apartment_number, zip_code, residential_units, commercial_units, total_units, land_square_feet, gross_square_feet, year_built, tax_class_at_time_of_sale, building_class_at_time_of_sale, sale_price, sale_date) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)]
[parameters: ((4.0, 'AIRPORT JFK', '31 COMMERCIAL VACANT LAND', '4', 14260.0, 80.0, 'E1', 'N/A ROCKAWAY BLVD', None, 11434.0, 0.0, 1.0, 1.0, 268092.0, 0.0, 2023.0, 4.0, 'V7', 0, 45224.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 25.0, 'A5', '19-30 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 780000, 45135.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 27.0, 'A5', '19-34 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 820000, 45092.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 38.0, 'A5', '19-56 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 0, 45069.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 41.0, 'A5', '19-62 81 STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 725000, 45215.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 949.0, 43.0, 'A5', '19-66 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1945.0, 1.0, 'A5', 820000, 45072.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 35.0, 'A5', '2160 81ST STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 0, 45291.0), (4.0, 'AIRPORT LA GUARDIA', '01 ONE FAMILY DWELLINGS', '1', 976.0, 41.0, 'A5', '2161 80 STREET', None, 11370.0, 1.0, 0.0, 1.0, 1800.0, 1224.0, 1950.0, 1.0, 'A5', 0, 45000.0)  ... displaying 10 of 24256 total bound parameter sets ...  (4.0, 'WOODSIDE', '46 CONDO STORE BUILDINGS', '4', 1216.0, 1102.0, 'RK', '61-05 39TH AVENUE, 1B', '1B', 11377.0, None, 1.0, 1.0, None, None, 1927.0, 4.0, 'RK', 978738, 45114.0), (4.0, 'WOODSIDE', '46 CONDO STORE BUILDINGS', '4', 1216.0, 1103.0, 'RK', '61-05 39TH AVENUE, 1C', '1C', 11377.0, None, 1.0, 1.0, None, None, 1927.0, 4.0, 'RK', 978738, 45114.0))]
(Background on this error at: https://sqlalche.me/e/14/9h9h)


==================================================
üèÅ Import Complete!
üìä Summary:
   - Files processed: 33
   - Files with errors: 19
   - Total records loaded: 625621
==================================================
üìò Log file: processing_log.txt
